<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sudoku â€” Clean Modern</title>

  <!-- Prevent forced dark mode / hint light color scheme -->
  <meta name="color-scheme" content="light">
  <meta name="theme-color" content="#F6F7F8">

  <!-- Font embed provided by user -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    *{ font-family: 'Press Start 2P', system-ui, -apple-system, 'Segoe UI', Roboto, Arial !important; }
    .press-start-2p-regular { font-family: 'Press Start 2P', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; font-weight:400; font-style:normal; }

    :root{
      --bg: #F6F7F8;
      --card: #FFFFFF;
      --muted: #9AA39A;
      --fg: #0F2614;
      --accent: #246B3B;
      --accent-2: #5FA86B;
      --glass: rgba(255,255,255,0.72);
      --shadow-sm: 0 6px 20px rgba(15,18,20,0.06);
      --shadow-lg: 0 24px 48px rgba(8,12,14,0.08);
      --cell: #FBFDF9;
      --given: #EDF7EE;
      --success: rgba(37,135,70,0.10);
      --danger: rgba(190,50,50,0.08);
      --focus: rgba(37,135,70,0.12);
      --board-size: 400px;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}

    html{
      color-scheme: light;
      -webkit-print-color-adjust: exact;
      color-adjust: exact;
    }

    body{
      font-family: 'Press Start 2P', system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
      background-color: var(--bg);
      background-image: none;
      color:var(--fg);
      display:flex;
      justify-content:center;
      align-items:flex-start;
      padding:36px 20px;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .wrap{
      width:100%;
      max-width:1120px;
      display:flex;
      gap:28px;
      align-items:flex-start;
      justify-content:center;
      position:relative;
    }

    .wrap::before{
      content:'';
      position:absolute;
      left:50%; transform:translateX(-50%);
      top:0;
      height:100%;
      width:calc(50% + 260px);
      background-color: var(--glass);
      border-radius:18px;
      filter: blur(8px);
      z-index:0;
      pointer-events:none;
      opacity:0.98;
    }

    .card{
      width:520px;
      background:var(--card);
      border-radius:12px;
      padding:18px;
      box-shadow:var(--shadow-lg);
      border:1px solid rgba(0,0,0,0.03);
      position:relative;
      z-index:1;
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .header{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .title-wrap{ display:flex; flex-direction:column; gap:2px; }
    .title{ font-weight:700; font-size:18px; letter-spacing:0; }
    .subtitle{ font-size:10px; color:var(--muted); font-weight:700; }

    .meta{ display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:6px; }
    .lives{ display:flex; align-items:center; gap:8px; color:var(--muted); font-weight:700; font-size:10px }
    .hearts{ display:flex; gap:6px; }
    .heart{ width:12px; height:12px; border-radius:3px; background:var(--accent-2);
      mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="black" d="M12 21s-7-4.35-9.17-7.09C1.25 11.97 2.4 8.5 5.5 7.5 7 6.9 8.5 7.5 9 8.6 9.5 7.5 11 6.9 12.5 7.5c3.1 1 4.25 4.47 2.67 6.41C19 16.65 12 21 12 21z"/></svg>') center / contain no-repeat;
      box-shadow: inset 0 2px 6px rgba(0,0,0,0.06);
    }

    .board-wrap{ display:flex; justify-content:center; align-items:center; padding:8px; }
    .sudoku{
      width:var(--board-size);
      height:var(--board-size);
      display:grid;
      grid-template-columns:repeat(9,1fr);
      grid-template-rows:repeat(9,1fr);
      border-radius:10px;
      overflow:visible;
      background:var(--cell);
      user-select:none;
      position:relative;
      box-shadow: 0 8px 20px rgba(8,12,14,0.03) inset;
      border:1px solid rgba(0,0,0,0.03);
    }

    .sudoku .cell{
      display:flex; align-items:center; justify-content:center; padding:0;
      font-weight:700; font-size:0.7rem; color:var(--fg);
      border-right:1px solid rgba(12,22,12,0.045);
      border-bottom:1px solid rgba(12,22,12,0.045);
      transition: box-shadow 140ms ease, background 120ms ease;
      min-width:0; min-height:0; position:relative; background:transparent;
      cursor:pointer;
      outline: none;
    }
    .sudoku .cell:nth-child(9n){ border-right:0; }
    .sudoku .cell:nth-last-child(-n+9){ border-bottom:0; }
    .sudoku .cell:nth-child(3n){ border-right:1.2px solid rgba(12,22,12,0.08); }
    .sudoku .cell:nth-child(n + 19):nth-child(-n + 27),
    .sudoku .cell:nth-child(n + 46):nth-child(-n + 54){ border-bottom:1.2px solid rgba(12,22,12,0.08); }

    .cell.given{ background:var(--given); color:var(--fg); opacity:0.98; pointer-events:none; }
    .cell.correct{ background:var(--success); }
    .cell.wrong{ background:var(--danger); }

    .cell input.value{
      width:100%; height:100%; border:0; background:transparent; text-align:center;
      font-weight:700; font-size:0.75rem; caret-color:transparent; /* hide caret so no blink */
      outline:none; -webkit-appearance:none; appearance:none; border-radius:0; padding-top:2px; color:inherit;
      pointer-events:none; /* make the input non-interactive: user interacts with cell div */
    }
    .cell input.value[readonly]{ -webkit-user-select: none; user-select:none; }

    .cell:hover:not(.given){ background: rgba(37,135,70,0.02); box-shadow: 0 6px 16px rgba(8,12,14,0.04); z-index:2; }
    .cell.active{ box-shadow: 0 14px 36px rgba(8,12,14,0.06); outline: 3px solid var(--focus); z-index:3; }

    .controls{ display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:6px; padding-top:6px; }
    .controls .left, .controls .right{ display:flex; gap:8px; align-items:center; }

    .controls .left{ display:flex; gap:4px; align-items:center; width:240px; justify-content:space-between; }

    .btn{ background:var(--accent); color:white; padding:9px 12px; border-radius:10px; font-weight:700; border:0; cursor:pointer; box-shadow:0 8px 18px rgba(36,107,59,0.10); transition: transform 120ms ease, opacity 120ms ease; font-size:10px }
    .btn.ghost{ background:transparent; color:var(--fg); border:1px solid rgba(0,0,0,0.04); box-shadow:none; font-weight:700; }
    .btn.small{ padding:8px 10px; font-size:9px; }

    .hint-pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:8px 12px;
      border-radius:6px;
      background: var(--accent);
      color: #fff;
      font-weight:800;
      box-shadow: 0 8px 24px rgba(36,107,59,0.12);
      cursor:pointer;
      border: 0;
      font-size:10px;
    }
    .hint-pill .icon{
      width:18px; height:18px; border-radius:6px; background: rgba(255,255,255,0.12); display:inline-flex; align-items:center; justify-content:center; font-size:12px;
    }

    .message{ font-size:10px; color:var(--muted); text-align:center; padding:6px 0 2px 0; }

    .aside{ width:340px; display:flex; align-items:center; justify-content:center; min-height: calc(100vh - 160px); z-index:1; }
    .numpad{
      width:300px; padding:10px; border-radius:12px;
      background-color: rgba(255,255,255,0.92);
      background-image: linear-gradient(180deg, rgba(255,255,255,0.92), rgba(255,255,255,0.88));
      box-shadow:var(--shadow-sm); border:1px solid rgba(0,0,0,0.03); display:grid; grid-template-columns:repeat(3, 1fr); grid-auto-rows:64px; gap:12px; align-items:stretch; justify-items:stretch; box-sizing:border-box;
    }

    .numpad button{ width:100%; height:100%; min-width:0; min-height:0; box-sizing:border-box; border-radius:10px; padding:10px; background:var(--accent); color:white; font-weight:700; font-size:12px; line-height:1; border:0; cursor:pointer; transition: transform 120ms ease; box-shadow:none; display:flex; align-items:center; justify-content:center; overflow:hidden; white-space:nowrap; text-overflow:ellipsis; }
    .numpad button.action{ background:transparent; color:var(--fg); border:1px solid rgba(0,0,0,0.04); font-weight:700; }

    @media (max-width:940px){
      body{ padding:20px; }
      .wrap{ gap:14px; flex-direction:column; align-items:center; max-width:880px; }
      .wrap::before{ width:92%; }
      .card{ width:92vw; max-width:620px; }
      .sudoku{ width:92vw; max-width:420px; height:92vw; }
      .aside{ width:92vw; min-height:auto; }
      .numpad{ width:92vw; max-width:420px; grid-template-columns: repeat(3, 1fr); }
      .controls .left{ width:100%; }
    }

    @media (prefers-reduced-motion:reduce){ *{ transition:none!important; } }

    @media (prefers-color-scheme: dark) {
      html { color-scheme: light; }
      body { background-color: var(--bg); color: var(--fg); }
      .wrap::before { background-color: var(--glass); }
      .numpad { background-color: rgba(255,255,255,0.92); }
    }

    button:focus, input:focus{ outline:none; }
  </style>
</head>
<body>
  <div class="wrap press-start-2p-regular" role="application" aria-label="Sudoku game">
    <div class="card" aria-live="polite">
      <div class="header">
        <div class="title-wrap">
          <div class="title">Sudoku</div>
          <div class="subtitle">Clean â€¢ Focused â€¢ Modern</div>
        </div>
        <div style="width:84px"></div>
      </div>

      <div class="meta">
        <div class="lives">Lives: <strong id="lives">3</strong> <span class="hearts" id="livesText"><span class="heart"></span><span class="heart"></span><span class="heart"></span></span></div>
        <div id="hintPill" class="hint-pill" role="button" aria-pressed="false" title="Get a hint">
          <span class="icon">ðŸ’¡</span>
          <span>Hint (<span id="hintCount">3</span>)</span>
        </div>
      </div>

      <div class="board-wrap">
        <div id="sudoku" class="sudoku" tabindex="0" aria-label="Sudoku board"></div>
      </div>

      <div class="controls">
        <div class="left">
          <button id="newBtn" class="btn">New Puzzle</button>
          <button id="solveBtn" class="btn ghost small">Show Solution</button>
          <button id="clearBtn2" class="btn ghost small">Clear</button>
        </div>
        <div class="right">
        </div>
      </div>

      <div class="message" id="message" aria-live="polite"></div>
    </div>

    <aside class="aside" aria-label="Number pad">
      <div id="numpad" class="numpad" role="toolbar" aria-label="Number pad">
        <button data-n="1">1</button><button data-n="2">2</button><button data-n="3">3</button>
        <button data-n="4">4</button><button data-n="5">5</button><button data-n="6">6</button>
        <button data-n="7">7</button><button data-n="8">8</button><button data-n="9">9</button>
        <button class="action" id="clearBtn">Clear</button>
        <button class="action" id="hintBtnMain">Hint</button>
        <button class="action" id="backBtn">âŒ«</button>
      </div>
    </aside>
  </div>

  <script>
    /* Prevent mobile keyboard: inputs are readonly and non-interactive; user uses the in-game numpad or physical keyboard */
    const SIZE = 9;
    let board = [];
    let solution = [];
    let initial = [];
    let lives = 3;
    let hintsLeft = 3;
    let selectedCell = null;

    const sudokuEl = document.getElementById('sudoku');
    const livesText = document.getElementById('livesText');
    const livesNum = document.getElementById('lives');
    const messageEl = document.getElementById('message');
    const hintCountEl = document.getElementById('hintCount');
    const hintPill = document.getElementById('hintPill');

    function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]] } return arr; }
    function fillBox(br,bc){ const nums = shuffle([1,2,3,4,5,6,7,8,9]); for(let r=0;r<3;r++) for(let c=0;c<3;c++) board[br+r][bc+c]=nums[r*3+c]; }
    function isValid(b,r,c,n){ for(let i=0;i<SIZE;i++){ if(b[r][i]===n || b[i][c]===n) return false; } const sr=r-r%3, sc=c-c%3; for(let i=0;i<3;i++) for(let j=0;j<3;j++) if(b[sr+i][sc+j]===n) return false; return true; }
    function solve(b){ for(let r=0;r<SIZE;r++){ for(let c=0;c<SIZE;c++){ if(b[r][c]===0){ for(let n=1;n<=9;n++){ if(isValid(b,r,c,n)){ b[r][c]=n; if(solve(b)) return true; b[r][c]=0; } } return false; } } } return true; }
    function removeCells(count){ let removed=0; while(removed<count){ const r=Math.floor(Math.random()*SIZE); const c=Math.floor(Math.random()*SIZE); if(board[r][c]!==0){ board[r][c]=0; removed++; } } }
    function generateRandomPuzzle(){ board = Array.from({length:SIZE},()=>Array(SIZE).fill(0)); for(let k=0;k<SIZE;k+=3) fillBox(k,k); solve(board); solution = board.map(r=>r.slice()); removeCells(50 + Math.floor(Math.random()*6)); initial = board.map(r=>r.slice()); }

    function initGrid(){
      sudokuEl.innerHTML='';
      for(let r=0;r<SIZE;r++){
        for(let c=0;c<SIZE;c++){
          const cell = document.createElement('div');
          cell.className='cell';
          cell.dataset.r=r; cell.dataset.c=c;
          cell.tabIndex = 0; // allow keyboard focus on desktop if needed
          const val = board[r][c];
          if(val!==0){
            const input = document.createElement('input'); input.className='value'; input.value=val; input.disabled=true;
            input.setAttribute('aria-label', `Cell ${r+1}-${c+1}`); input.setAttribute('readonly',''); input.setAttribute('inputmode','none');
            cell.appendChild(input); cell.classList.add('given');
          } else {
            const input = document.createElement('input'); input.className='value';
            input.type='text'; input.readOnly = true; input.inputMode='none'; input.maxLength=1; input.autocomplete='off';
            input.style.display='block';
            input.setAttribute('aria-label', `Cell ${r+1}-${c+1}`);
            // make input non-interactive so mobile won't open keyboard; we handle selection on the cell
            input.disabled = false; // keep enabled so value is visible and can be changed by JS
            input.setAttribute('readonly','');
            // click/touch on the cell div selects â€” do NOT focus the input (prevents keyboard)
            cell.addEventListener('click', ()=>setSelected(cell,r,c));
            cell.addEventListener('touchstart', (ev)=>{ ev.preventDefault(); setSelected(cell,r,c); }, {passive:false});
            // support keyboard focus navigation on desktop: allow Enter/number keys via document-level handler
            cell.addEventListener('keydown', (e)=>{ /* keep for accessibility but primary keyboard handling is on document */ });
            cell.appendChild(input);
          }
          sudokuEl.appendChild(cell);
        }
      }
    }

    function setSelected(el,row,col){
      document.querySelectorAll('.sudoku .cell').forEach(c=>c.classList.remove('active'));
      el.classList.add('active');
      selectedCell={row,col,el};
      // IMPORTANT: do NOT focus the input (that would open mobile keyboard). We intentionally focus the cell div instead.
      try{ el.focus(); }catch(e){}
    }

    // Handle physical keyboard input (desktop) + delete/backspace + arrows
    document.addEventListener('keydown', (e)=>{
      if(!selectedCell) {
        if(e.key === 'Enter') focusFirstEmpty();
        return;
      }
      const r = selectedCell.row, c = selectedCell.col;
      if(e.key==='ArrowUp'){ e.preventDefault(); focusCell(Math.max(0,r-1),c); return; }
      if(e.key==='ArrowDown'){ e.preventDefault(); focusCell(Math.min(8,r+1),c); return; }
      if(e.key==='ArrowLeft'){ e.preventDefault(); focusCell(r,Math.max(0,c-1)); return; }
      if(e.key==='ArrowRight'){ e.preventDefault(); focusCell(r,Math.min(8,c+1)); return; }
      if(e.key==='Backspace' || e.key==='Delete'){ e.preventDefault(); clearSelected(); return; }
      if(e.key>='1' && e.key<='9'){ const n = parseInt(e.key); enterNumber(n, r, c); return; }
    });

    function enterNumber(n, row, col){
      const idx = row*9 + col;
      const cell = sudokuEl.children[idx];
      if(!cell) return;
      const inp = cell.querySelector('input.value');
      if(!inp || inp.disabled) return;
      // place value & validate
      inp.value = n;
      if(n === solution[row][col]){
        inp.disabled=true;
        cell.classList.add('correct');
        cell.classList.remove('active');
        selectedCell = null;
      } else {
        lives--; updateLives();
        cell.classList.add('wrong');
        setTimeout(()=>{ cell.classList.remove('wrong'); inp.value=''; },500);
        if(lives<=0){ showMessage('ðŸ’€ Game Over â€” new puzzle loading...','error'); setTimeout(()=>newPuzzle(),1200); }
      }
    }

    function clearSelected(){ if(!selectedCell) return; const inp = selectedCell.el.querySelector('input.value'); if(inp && !inp.disabled) inp.value=''; selectedCell.el.classList.remove('active'); selectedCell=null; }

    function updateLives(){ livesText.innerHTML=''; for(let i=0;i<lives;i++){ const h=document.createElement('span'); h.className='heart'; livesText.appendChild(h);} document.getElementById('lives').textContent=lives; }

    function showMessage(text,type='info'){ messageEl.textContent=text; if(type!=='error') setTimeout(()=>{ if(messageEl.textContent===text) messageEl.textContent=''; },1300); }

    function giveHint(){
      if(hintsLeft<=0){ showMessage('No hints left!','error'); return; }
      if(!selectedCell){ showMessage('Select a cell first!','error'); return; }
      const r=selectedCell.row, c=selectedCell.col;
      if(board[r][c]!==0){ showMessage('Cell already filled!','error'); return; }
      const inp = selectedCell.el.querySelector('input.value');
      inp.value = solution[r][c];
      inp.disabled = true;
      selectedCell.el.classList.add('correct');
      selectedCell=null;
      hintsLeft--; updateHintDisplay();
    }

    function updateHintDisplay(){ hintCountEl.textContent=hintsLeft; }

    function revealSolution(){ for(let r=0;r<9;r++){ for(let c=0;c<9;c++){ const idx=r*9+c; const cell=sudokuEl.children[idx]; const inp=cell.querySelector('input.value'); if(inp){ inp.value = solution[r][c]; inp.disabled=true; cell.classList.add('correct'); } } } }
    function newPuzzle(){ lives=3; hintsLeft=3; updateLives(); updateHintDisplay(); generateRandomPuzzle(); initGrid(); showMessage('New puzzle â€” good luck!'); selectedCell=null; }
    function clearAll(){ for(let i=0;i<81;i++){ const cell=sudokuEl.children[i]; const inp=cell.querySelector('input.value'); if(inp && !inp.disabled) inp.value=''; cell.classList.remove('correct','wrong','active'); } }

    // numpad interactions
    document.getElementById('numpad').addEventListener('click',(e)=>{
      const btn = e.target.closest('button'); if(!btn) return;
      const n = btn.dataset.n;
      if(btn.id==='clearBtn'){ clearSelected(); return; }
      if(btn.id==='backBtn'){ clearSelected(); return; }
      if(btn.id==='hintBtnMain'){ giveHint(); return; }
      if(n){ if(!selectedCell){ showMessage('Select a cell first!','error'); return; } enterNumber(parseInt(n), selectedCell.row, selectedCell.col); }
    });

    // controls
    document.getElementById('newBtn').addEventListener('click', newPuzzle);
    document.getElementById('solveBtn').addEventListener('click', ()=>{ revealSolution(); showMessage('Solution revealed'); });
    document.getElementById('clearBtn2').addEventListener('click', clearAll);
    hintPill.addEventListener('click', giveHint);
    document.getElementById('hintBtnMain').addEventListener('click', giveHint);

    // init
    generateRandomPuzzle();
    initGrid();
    updateLives();
    updateHintDisplay();
    focusFirstEmpty();

    window.sudoku = { newPuzzle, revealSolution, getBoard: ()=>board.map(r=>r.slice()), getSolution: ()=>solution.map(r=>r.slice()) };

    // helpers
    function focusFirstEmpty(){ for(let r=0;r<9;r++) for(let c=0;c<9;c++) if(board[r][c]===0){ focusCell(r,c); return; } }
    function focusCell(r,c){ const idx=r*9+c; const target=sudokuEl.children[idx]; if(target){ setSelected(target,r,c); } }
  </script>
</body>
</html>
